<div class="spinner" *ngIf="isLoading">
    <mat-spinner color="accent"></mat-spinner>
</div>

<div class="teamsStatsTable" *ngIf="!isLoading">

    <div class="tableHeader">
        <p>League Stats</p>
    </div>

    <div class="table">
        <table mat-table [dataSource]="teams" matSort class="mat-elevation-z8 full-width" matSortActive="points" matSortDirection="desc">

            <ng-container matColumnDef="team_name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Team </th>
                <td mat-cell *matCellDef="let team"> {{team.team_name}} </td>
            </ng-container>

            <ng-container matColumnDef="games_played">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> GP </th>
                <td mat-cell *matCellDef="let team"> {{team.games_played}} </td>
            </ng-container>

            <ng-container matColumnDef="wins">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> W </th>
                <td mat-cell *matCellDef="let team"> {{team.wins}} </td>
            </ng-container>
            
            <ng-container matColumnDef="loss">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> L </th>
                <td mat-cell *matCellDef="let team"> {{team.loss}} </td>
            </ng-container>
            
            <ng-container matColumnDef="ties">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> T </th>
                <td mat-cell *matCellDef="let team"> {{team.ties}} </td>
            </ng-container>
            
            <ng-container matColumnDef="points">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Pts </th>
                <td mat-cell *matCellDef="let team"> {{team.points}} </td>
            </ng-container>

            <ng-container matColumnDef="goals_for">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> GF </th>
                <td mat-cell *matCellDef="let team"> {{team.goals_for}} </td>
            </ng-container>

            <ng-container matColumnDef="goals_for_game">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> GF/g </th>
                <td mat-cell *matCellDef="let team"> {{ (team.goals_for / team.games_played).toFixed(2) }} </td>
            </ng-container>

            <ng-container matColumnDef="goals_against">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> GA </th>
                <td mat-cell *matCellDef="let team"> {{team.goals_against}} </td>
            </ng-container>

            <ng-container matColumnDef="goals_against_game">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> GA/g </th>
                <td mat-cell *matCellDef="let team"> {{ (team.goals_against / team.games_played).toFixed(2) }} </td>
            </ng-container>

            <ng-container matColumnDef="goals_diff">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Goal Diff </th>
                <td mat-cell *matCellDef="let team"> {{team.goals_for - team.goals_against}} </td>
            </ng-container>

            <ng-container matColumnDef="win_pct">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Win % </th>
                <td mat-cell *matCellDef="let team"> {{((team.wins / team.games_played) * 100).toFixed(1)}} %</td>
            </ng-container>

            <ng-container matColumnDef="pp_pct">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PP % </th>
                <td mat-cell *matCellDef="let team"> {{ ((team.pp_goals / team.pp_attempts) * 100).toFixed(1) }} %</td>
            </ng-container>

            <ng-container matColumnDef="pk_pct">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PK % </th>
                <td mat-cell *matCellDef="let team"> {{ (((team.pk_attempts - team.pk_goals) / team.pk_attempts) * 100).toFixed(1)}} %</td>
            </ng-container>

            <ng-container matColumnDef="sh_goals">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> SHG </th>
                <td mat-cell *matCellDef="let team"> {{ team.sh_goals}} </td>
            </ng-container>

            <ng-container matColumnDef="penalty_minutes_game">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PIM/g </th>
                <td mat-cell *matCellDef="let team"> {{ (team.penalty_minutes / team.games_played).toFixed(1)}} </td>
            </ng-container>

            <ng-container matColumnDef="shot_diff">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Shot Diff </th>
                <td mat-cell *matCellDef="let team"> {{ (team.shots_for - team.shots_against) }} </td>
            </ng-container>

            <ng-container matColumnDef="div_record">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Div </th>
                <td mat-cell *matCellDef="let team"> {{team.div_win}}-{{team.div_loss}}-{{team.div_tie}} </td>
            </ng-container>

            <ng-container matColumnDef="home_record">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Home </th>
                <td mat-cell *matCellDef="let team"> {{team.home_wins}}-{{team.home_loss}}-{{team.home_ties}} </td>
            </ng-container>

            <ng-container matColumnDef="away_record">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Away </th>
                <td mat-cell *matCellDef="let team"> {{team.road_wins}}-{{team.road_loss}}-{{team.road_ties}} </td>
            </ng-container>

            <ng-container matColumnDef="trail_record">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Trailing After 2 </th>
                <td mat-cell *matCellDef="let team"> {{team.trail_after_two_wins}}-{{team.trail_after_two_loss}}-{{team.trail_after_two_ties}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="teamsColumnsToDisplay"></tr>
            <tr mat-row *matRowDef="let row; columns: teamsColumnsToDisplay;"></tr>

        </table>

        <mat-paginator
            [pageSizeOptions]="[10]"
            [pageSize]="pageSize"
            [length]="length"
            color="accent"
            showFirstLastButtons
        ></mat-paginator>

    </div>

</div>
    
